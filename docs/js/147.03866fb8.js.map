{"version":3,"file":"js/147.03866fb8.js","mappings":"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","sources":["webpack://zhiyuxinsheng/./src/views/ResetPassword.vue","webpack://zhiyuxinsheng/./src/views/ResetPassword.vue?9dd8"],"sourcesContent":["<template>\r\n  <div class=\"reset-container\">\r\n    <div class=\"reset-card\">\r\n      <div class=\"reset-header\">\r\n        <div class=\"app-logo\">\r\n          <el-icon class=\"logo-icon\"><Sunny /></el-icon>\r\n          <h1>植物日记</h1>\r\n        </div>\r\n        <p class=\"reset-subtitle\">重置您的账户密码</p>\r\n      </div>\r\n      \r\n      <div class=\"reset-form\">\r\n        <p class=\"instruction\">请设置您的新密码。密码应至少为6个字符，并包含数字和字母。</p>\r\n        \r\n        <el-form \r\n          ref=\"resetForm\" \r\n          :model=\"resetForm\" \r\n          :rules=\"rules\" \r\n          label-position=\"top\"\r\n          @keyup.enter=\"handleSubmit\"\r\n        >\r\n          <el-form-item label=\"新密码\" prop=\"password\">\r\n            <el-input \r\n              v-model=\"resetForm.password\" \r\n              type=\"password\" \r\n              placeholder=\"请输入新密码\" \r\n              prefix-icon=\"Lock\"\r\n              show-password\r\n              clearable\r\n            />\r\n          </el-form-item>\r\n          \r\n          <el-form-item label=\"确认新密码\" prop=\"confirmPassword\">\r\n            <el-input \r\n              v-model=\"resetForm.confirmPassword\" \r\n              type=\"password\" \r\n              placeholder=\"请再次输入新密码\" \r\n              prefix-icon=\"Lock\"\r\n              show-password\r\n              clearable\r\n            />\r\n          </el-form-item>\r\n          \r\n          <el-form-item>\r\n            <el-button \r\n              type=\"primary\" \r\n              class=\"submit-button\" \r\n              :loading=\"authStore.loading\"\r\n              @click=\"handleSubmit\"\r\n            >\r\n              重置密码\r\n            </el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n        \r\n        <div class=\"back-link\">\r\n          <router-link to=\"/login\">\r\n            <el-icon><Back /></el-icon> 返回登录页\r\n          </router-link>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive } from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\nimport { useAuthStore } from '../stores/auth'\r\nimport { Sunny, Lock, Back } from '@element-plus/icons-vue'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nexport default {\r\n  name: 'ResetPasswordPage',\r\n  components: {\r\n    Sunny,\r\n    Lock,\r\n    Back\r\n  },\r\n  setup() {\r\n    const router = useRouter()\r\n    const route = useRoute()\r\n    const authStore = useAuthStore()\r\n    const resetForm = ref(null)\r\n    \r\n    // 从路由参数中获取重置令牌\r\n    const token = route.params.token\r\n    \r\n    const formData = reactive({\r\n      password: '',\r\n      confirmPassword: ''\r\n    })\r\n    \r\n    // 验证密码是否一致\r\n    const validatePass2 = (rule, value, callback) => {\r\n      if (value === '') {\r\n        callback(new Error('请再次输入密码'))\r\n      } else if (value !== formData.password) {\r\n        callback(new Error('两次输入密码不一致'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    \r\n    const rules = {\r\n      password: [\r\n        { required: true, message: '请输入新密码', trigger: 'blur' },\r\n        { min: 6, message: '密码长度至少为6个字符', trigger: 'blur' }\r\n      ],\r\n      confirmPassword: [\r\n        { required: true, validator: validatePass2, trigger: 'blur' }\r\n      ]\r\n    }\r\n    \r\n    const handleSubmit = async () => {\r\n      if (!resetForm.value) return\r\n      \r\n      if (!token) {\r\n        ElMessage.error('无效的重置链接，请重新获取')\r\n        router.push('/forgot-password')\r\n        return\r\n      }\r\n      \r\n      await resetForm.value.validate(async (valid) => {\r\n        if (valid) {\r\n          try {\r\n            await authStore.resetPassword({\r\n              token,\r\n              password: formData.password\r\n            })\r\n            \r\n            // 成功重置后提示用户\r\n            ElMessage.success('密码已成功重置，请使用新密码登录！')\r\n            \r\n            // 短暂延迟后跳转到登录页\r\n            setTimeout(() => {\r\n              router.push('/login')\r\n            }, 2000)\r\n          } catch (error) {\r\n            // 错误已在authStore中处理\r\n            console.error('重置密码失败:', error)\r\n          }\r\n        } else {\r\n          ElMessage.warning('请正确填写密码信息')\r\n          return false\r\n        }\r\n      })\r\n    }\r\n    \r\n    return {\r\n      resetForm,\r\n      resetForm: formData,\r\n      rules,\r\n      authStore,\r\n      handleSubmit\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.reset-container {\r\n  display: flex;\r\n  min-height: 100vh;\r\n  background-color: #f5f7fa;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n\r\n.reset-card {\r\n  width: 100%;\r\n  max-width: 450px;\r\n  margin: auto;\r\n  padding: 40px;\r\n  background-color: #fff;\r\n  border-radius: 16px;\r\n  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.05);\r\n  z-index: 2;\r\n  position: relative;\r\n}\r\n\r\n.reset-header {\r\n  text-align: center;\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.app-logo {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.logo-icon {\r\n  font-size: 48px;\r\n  color: #4caf50;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.app-logo h1 {\r\n  font-size: 28px;\r\n  color: #333;\r\n  margin: 0;\r\n  font-weight: 600;\r\n}\r\n\r\n.reset-subtitle {\r\n  color: #666;\r\n  font-size: 16px;\r\n  margin: 0;\r\n}\r\n\r\n.reset-form {\r\n  margin-top: 20px;\r\n}\r\n\r\n.instruction {\r\n  color: #666;\r\n  margin-bottom: 30px;\r\n  line-height: 1.6;\r\n}\r\n\r\n.submit-button {\r\n  width: 100%;\r\n  height: 44px;\r\n  font-size: 16px;\r\n  border-radius: 8px;\r\n  background: linear-gradient(135deg, #4caf50, #2e7d32);\r\n  border: none;\r\n}\r\n\r\n.back-link {\r\n  text-align: center;\r\n  margin-top: 30px;\r\n}\r\n\r\n.back-link a {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  color: #4caf50;\r\n  text-decoration: none;\r\n  font-size: 14px;\r\n}\r\n\r\n.back-link a:hover {\r\n  text-decoration: underline;\r\n}\r\n\r\n.back-link .el-icon {\r\n  margin-right: 5px;\r\n}\r\n\r\n.reset-decoration {\r\n  position: fixed;\r\n  top: -20px;\r\n  left: -20px;\r\n  width: 50%;\r\n  max-width: 700px;\r\n  opacity: 0.5;\r\n  z-index: 1;\r\n}\r\n\r\n.reset-decoration img {\r\n  width: 100%;\r\n  height: auto;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .reset-card {\r\n    max-width: 100%;\r\n    border-radius: 0;\r\n    box-shadow: none;\r\n    padding: 30px 20px;\r\n  }\r\n  \r\n  .reset-decoration {\r\n    display: none;\r\n  }\r\n}\r\n</style> ","import { render } from \"./ResetPassword.vue?vue&type=template&id=ff66de68&scoped=true\"\nimport script from \"./ResetPassword.vue?vue&type=script&lang=js\"\nexport * from \"./ResetPassword.vue?vue&type=script&lang=js\"\n\nimport \"./ResetPassword.vue?vue&type=style&index=0&id=ff66de68&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-ff66de68\"]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_createVNode","_component_el_icon","default","_withCtx","_component_Sunny","_","_hoisted_5","_component_el_form","ref","model","$setup","resetForm","rules","onKeyup","_withKeys","handleSubmit","_component_el_form_item","label","prop","_component_el_input","modelValue","password","_cache","$event","type","placeholder","clearable","confirmPassword","_component_el_button","loading","authStore","onClick","_createTextVNode","_hoisted_6","_component_router_link","to","_component_Back","name","components","Sunny","Lock","Back","setup","router","useRouter","route","useRoute","useAuthStore","token","params","formData","reactive","validatePass2","rule","value","callback","Error","required","message","trigger","min","validator","async","validate","valid","ElMessage","warning","resetPassword","success","setTimeout","push","error","console","__exports__","render"],"sourceRoot":""}