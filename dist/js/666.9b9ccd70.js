"use strict";(self["webpackChunkzhiyuxinsheng"]=self["webpackChunkzhiyuxinsheng"]||[]).push([[666],{178:function(a,t,e){a.exports=e.p+"img/1-1.eaa93a9a.png"},403:function(a,t,e){a.exports=e.p+"img/2-3.e7e6ea17.png"},529:function(a,t,e){a.exports=e.p+"img/2-1.eaa93a9a.png"},902:function(a,t,e){a.exports=e.p+"img/5-1.eaa93a9a.png"},1145:function(a,t,e){a.exports=e.p+"img/1-2.e301c84e.png"},1546:function(a,t,e){a.exports=e.p+"img/2-2.ff769eac.png"},2214:function(a,t,e){a.exports=e.p+"img/3-3.a4c025b0.png"},2292:function(a,t,e){a.exports=e.p+"img/3-1.eaa93a9a.png"},2333:function(a,t,e){e.d(t,{O:function(){return d}});e(4114),e(8111),e(2489),e(116);var i=e(2261),r=e(144),n=e(6768),o=e(3271),s=e(4300),l=e(1219);const d=(0,i.nY)("task",(()=>{const a=(0,r.KR)([]),t=(0,r.KR)([]),e=(0,r.KR)([]),i=(0,r.KR)(!1),d=(0,n.EW)((()=>a.value.filter((a=>!a.completed)))),h=async()=>{try{i.value=!0;const t=await s.WY.getTasks();a.value=t.tasks.filter((a=>!a.completed)),e.value=t.tasks.filter((a=>a.completed))}catch(t){l.nk.error("获取任务列表失败")}finally{i.value=!1}},c=async()=>{try{i.value=!0;const a=await s.WY.getSystemTasks();t.value=a.tasks}catch(a){l.nk.error("获取系统任务失败")}finally{i.value=!1}},p=async t=>{try{const e=await s.WY.createTask({title:t.title,description:t.description||"",deadline:t.deadline||"",important:t.important||!1});a.value.push(e.task),l.nk.success("任务创建成功")}catch(e){l.nk.error("创建任务失败")}},u=async t=>{try{await s.WY.completeTask(t);const i=a.value.find((a=>a._id===t));i&&(e.value.unshift({...i,completed:!0,completedAt:(new Date).toISOString()}),a.value=a.value.filter((a=>a._id!==t)));const r=(0,o.g)();if(r.plants&&r.plants.length>0){const a=r.plants.find((a=>a.isMainPlant));if(a){const t=a._id||a.id;if(t){const a=i&&i.important?50:25;await r.gainExperience(t,a),l.nk.success(`任务已完成，获得 ${a} 点经验值！`)}}}else l.nk.success("任务已完成")}catch(i){l.nk.error("完成任务失败")}},y=async a=>{try{const e=(0,o.g)();if(!e.currentPlant)return l.nk.warning("请先添加一个植物"),!1;const i=await s.WY.completeSystemTask(a),r=t.value.findIndex((t=>t._id===a));if(-1!==r&&(t.value[r].completed=!0),i.rewards)l.nk.success(`完成任务获得 ${i.rewards.experience} 点经验`);else{const a=e.currentPlant._id||e.currentPlant.id;if(a){const t=35;await e.gainExperience(a,t),l.nk.success(`完成系统任务获得 ${t} 点经验值`)}}return!0}catch(e){return 400===e.response?.status?l.nk.warning("今天已经完成过此任务"):l.nk.error("完成系统任务失败"),!1}},g=async t=>{try{if(!t)return void l.nk.error("任务ID无效，无法删除");await s.WY.deleteTask(t),a.value=a.value.filter((a=>a._id!==t)),l.nk.success("任务已删除")}catch(e){console.error("删除任务失败:",e),l.nk.error("删除任务失败")}},f=async a=>{try{if(!a)return void l.nk.error("任务ID无效，无法删除");await s.WY.deleteTask(a),e.value=e.value.filter((t=>t._id!==a)),l.nk.success("任务已删除")}catch(t){console.error("删除任务失败:",t),l.nk.error("删除任务失败")}},m=async t=>{try{const{_id:e,title:i,description:r,deadline:n,important:o}=t,d=await s.WY.updateTask(e,{title:i,description:r,deadline:n,important:o}),h=a.value.findIndex((a=>a._id===e));-1!==h&&(a.value[h]=d.task),l.nk.success("任务已更新")}catch(e){l.nk.error("更新任务失败")}},M=async t=>{const e=a.value.find((a=>a._id===t));e&&await m({...e,important:!e.important})};return{tasks:a,systemTasks:t,completedTasks:e,pendingTasks:d,loading:i,fetchTasks:h,fetchSystemTasks:c,addTask:p,completeTask:u,completeSystemTask:y,removeTask:g,removeCompletedTask:f,updateTask:m,toggleTaskImportance:M}}))},2669:function(a,t,e){a.exports=e.p+"img/5-2.e26c060e.png"},3024:function(a,t,e){a.exports=e.p+"img/1-3.74393638.png"},3107:function(a,t,e){a.exports=e.p+"img/4-2.b7d3c88c.png"},7243:function(a,t,e){a.exports=e.p+"img/4-1.eaa93a9a.png"},7593:function(a,t,e){a.exports=e.p+"img/4-3.2b85cb4d.png"},9104:function(a,t,e){e.d(t,{A:function(){return c}});var i=e(6768),r=e(4232);const n={class:"dialog-bubble"},o={class:"dialog-text"},s={key:0,class:"dialog-buttons"};var l={__name:"PlantDialog",props:{text:{type:String,required:!0},isVisible:{type:Boolean,default:!1},showButtons:{type:Boolean,default:!1},primaryButtonText:{type:String,default:"确定"},secondaryButtonText:{type:String,default:"取消"}},emits:["primary-action","secondary-action"],setup(a){return(t,e)=>{const l=(0,i.g2)("el-button");return(0,i.uX)(),(0,i.CE)("div",{class:(0,r.C4)(["plant-dialog",{show:a.isVisible}])},[(0,i.Lk)("div",n,[(0,i.Lk)("p",o,(0,r.v_)(a.text),1),a.showButtons?((0,i.uX)(),(0,i.CE)("div",s,[(0,i.bF)(l,{size:"small",type:"primary",onClick:e[0]||(e[0]=a=>t.$emit("primary-action"))},{default:(0,i.k6)((()=>[(0,i.eW)((0,r.v_)(a.primaryButtonText),1)])),_:1}),(0,i.bF)(l,{size:"small",onClick:e[1]||(e[1]=a=>t.$emit("secondary-action"))},{default:(0,i.k6)((()=>[(0,i.eW)((0,r.v_)(a.secondaryButtonText),1)])),_:1})])):(0,i.Q3)("",!0)]),e[2]||(e[2]=(0,i.Lk)("div",{class:"dialog-tail"},null,-1))],2)}}},d=e(1241);const h=(0,d.A)(l,[["__scopeId","data-v-ac86cebe"]]);var c=h},9151:function(a,t,e){a.exports=e.p+"img/3-2.57f7796f.png"},9428:function(a,t,e){a.exports=e.p+"img/5-3.d4662e32.png"},9523:function(a,t,e){e.d(t,{A:function(){return l}});e(4114),e(8111),e(7588);var i=e(6768),r=e(144),n={__name:"WeatherCanvas",props:{weather:{type:String,required:!0,default:"sunny",validator:a=>["sunny","rainy","cloudy"].includes(a)},width:{type:Number,default:300},height:{type:Number,default:300}},setup(a){const t=a,e=(0,r.KR)(null);let n=null,o=null,s=[],l=null;const d=()=>{if(!e.value)return;const a=window.devicePixelRatio||1;n=e.value.getContext("2d"),e.value.width=t.width*a,e.value.height=t.height*a,n.scale(a,a),s=[],h(),"rainy"===t.weather?c():"sunny"===t.weather?p():"cloudy"===t.weather&&u(),w()},h=()=>{"sunny"===t.weather?(l=n.createLinearGradient(0,0,0,t.height),l.addColorStop(0,"rgba(135, 206, 250, 0.3)"),l.addColorStop(1,"rgba(135, 206, 250, 0)")):"rainy"===t.weather?(l=n.createLinearGradient(0,0,0,t.height),l.addColorStop(0,"rgba(105, 105, 105, 0.2)"),l.addColorStop(1,"rgba(105, 105, 105, 0)")):"cloudy"===t.weather&&(l=n.createLinearGradient(0,0,0,t.height),l.addColorStop(0,"rgba(200, 200, 200, 0.2)"),l.addColorStop(1,"rgba(200, 200, 200, 0)"))},c=()=>{const a=180;for(let e=0;e<a;e++){const a=Math.random()>.9;a?s.push({type:"splash",x:Math.random()*t.width,y:t.height-10,radius:3*Math.random()+1,speedX:3*Math.random()-1.5,speedY:5*-Math.random()-2,gravity:.2,life:30*Math.random()+30,opacity:.7}):s.push({type:"raindrop",x:Math.random()*t.width,y:Math.random()*t.height-t.height,length:20*Math.random()+10,speed:12*Math.random()+8,thickness:1.8*Math.random()+.5,windOffset:.5*Math.sin(Math.random()*Math.PI)})}},p=()=>{s.push({type:"sun",x:.75*t.width,y:.25*t.height,radius:.1*t.width,rayLength:.08*t.width,rayCount:12,rotation:0,rotationSpeed:.002,pulse:0,pulseSpeed:.03});for(let a=0;a<40;a++)s.push({type:"sparkle",x:Math.random()*t.width,y:Math.random()*t.height,radius:3*Math.random()+1,alpha:.5*Math.random()+.3,speed:.5*Math.random()+.2,pulse:Math.random()*Math.PI*2});for(let a=0;a<3;a++)s.push({type:"smallCloud",x:Math.random()*t.width,y:Math.random()*(.4*t.height),radius:20*Math.random()+15,speed:.3*Math.random()+.1,opacity:.2*Math.random()+.1})},u=()=>{for(let a=0;a<5;a++)s.push({type:"bigCloud",x:Math.random()*t.width*1.5-.25*t.width,y:Math.random()*(.6*t.height),radius:60*Math.random()+40,speed:.4*Math.random()+.1,opacity:.5*Math.random()+.4,details:Math.floor(3*Math.random())+3});for(let a=0;a<8;a++)s.push({type:"smallCloud",x:Math.random()*t.width*1.5-.25*t.width,y:Math.random()*(.8*t.height),radius:30*Math.random()+15,speed:.6*Math.random()+.2,opacity:.4*Math.random()+.2})},y=()=>{n.clearRect(0,0,t.width,t.height),n.fillStyle=l,n.fillRect(0,0,t.width,t.height),s.forEach(((a,e)=>{if("raindrop"===a.type){const e=Math.min(1,a.speed/15);if(n.strokeStyle=`rgba(174, 194, 224, ${e})`,n.lineCap="round",n.beginPath(),n.lineWidth=a.thickness,n.moveTo(a.x,a.y),n.lineTo(a.x+a.windOffset,a.y+a.length),n.stroke(),a.y+=a.speed,a.x+=.5*a.windOffset,a.y>t.height){if(Math.random()>.7)for(let e=0;e<3;e++)s.push({type:"splash",x:a.x,y:t.height-5,radius:2*Math.random()+1,speedX:3*Math.random()-1.5,speedY:3*-Math.random()-2,gravity:.15,life:20*Math.random()+10,opacity:.7});a.y=-a.length,a.x=Math.random()*t.width,a.windOffset=.5*Math.sin(Math.random()*Math.PI)}}else"splash"===a.type&&(n.fillStyle=`rgba(174, 194, 224, ${a.opacity})`,n.beginPath(),n.arc(a.x,a.y,a.radius,0,2*Math.PI),n.fill(),a.x+=a.speedX,a.y+=a.speedY,a.speedY+=a.gravity,a.life--,a.opacity=a.life/40,a.life<=0&&s.splice(e,1))}))},g=()=>{n.clearRect(0,0,t.width,t.height),n.fillStyle=l,n.fillRect(0,0,t.width,t.height),s.forEach(((a,e)=>{if("sun"===a.type){const t=a;t.pulse+=t.pulseSpeed;const e=n.createRadialGradient(t.x,t.y,.5*t.radius,t.x,t.y,3.5*t.radius);e.addColorStop(0,"rgba(255, 220, 130, 0.3)"),e.addColorStop(.5,"rgba(255, 210, 100, 0.15)"),e.addColorStop(1,"rgba(255, 210, 100, 0)"),n.fillStyle=e,n.beginPath(),n.arc(t.x,t.y,3.5*t.radius,0,2*Math.PI),n.fill();const i=1+.05*Math.sin(.5*t.pulse),r=n.createRadialGradient(t.x,t.y,.2*t.radius,t.x,t.y,2*t.radius*i);r.addColorStop(0,"rgba(255, 220, 130, 0.7)"),r.addColorStop(.5,"rgba(255, 190, 80, 0.3)"),r.addColorStop(1,"rgba(255, 180, 80, 0)"),n.fillStyle=r,n.beginPath(),n.arc(t.x,t.y,2*t.radius*i,0,2*Math.PI),n.fill();const o=t.x-.3*t.radius,s=t.y-.3*t.radius,l=n.createRadialGradient(o,s,0,t.x,t.y,t.radius);l.addColorStop(0,"#FFF8E1"),l.addColorStop(.4,"#FFECB3"),l.addColorStop(.8,"#FFD54F"),l.addColorStop(1,"#FFB300"),n.fillStyle=l,n.beginPath(),n.arc(t.x,t.y,t.radius,0,2*Math.PI),n.fill(),n.strokeStyle="rgba(255, 213, 79, 0.7)";for(let a=0;a<t.rayCount;a++){const e=a*(2*Math.PI)/t.rayCount+t.rotation,i=t.rayLength*(.85+.15*Math.sin(.8*t.pulse+.3*a)),r=t.x+Math.cos(e)*(t.radius+2),o=t.y+Math.sin(e)*(t.radius+2),s=t.x+Math.cos(e)*(t.radius+i),l=t.y+Math.sin(e)*(t.radius+i);n.lineWidth=2+1.5*Math.sin(t.pulse+.5*a),n.globalAlpha=.7+.2*Math.sin(t.pulse+.3*a),n.beginPath(),n.moveTo(r,o),n.lineTo(s,l),n.stroke()}n.strokeStyle="rgba(255, 213, 79, 0.5)",n.lineWidth=1.5;for(let a=0;a<2*t.rayCount;a++){const e=a*(2*Math.PI)/(2*t.rayCount)+1.5*t.rotation,i=.4*t.rayLength*(.7+.3*Math.sin(1.2*t.pulse+.5*a)),r=t.x+Math.cos(e)*(t.radius+2),o=t.y+Math.sin(e)*(t.radius+2),s=t.x+Math.cos(e)*(t.radius+i),l=t.y+Math.sin(e)*(t.radius+i);n.globalAlpha=.2+.2*Math.cos(.8*t.pulse+a),n.beginPath(),n.moveTo(r,o),n.lineTo(s,l),n.stroke()}n.fillStyle="rgba(255, 230, 160, 0.3)";for(let a=0;a<8;a++){const e=a*(2*Math.PI)/8+.7*t.rotation,i=t.radius*(1.6+.15*Math.sin(.9*t.pulse)),r=t.x+Math.cos(e)*i,o=t.y+Math.sin(e)*i,s=t.x+Math.cos(e+.2)*(.7*i),l=t.y+Math.sin(e+.2)*(.7*i),d=t.x+Math.cos(e-.2)*(.7*i),h=t.y+Math.sin(e-.2)*(.7*i);n.globalAlpha=.15+.1*Math.sin(t.pulse+.7*a),n.beginPath(),n.moveTo(r,o),n.lineTo(s,l),n.lineTo(d,h),n.closePath(),n.fill()}n.fillStyle="rgba(255, 250, 230, 0.7)";for(let a=0;a<3;a++){const e=2*t.rotation+a*Math.PI/2.5,i=.5*t.radius*Math.random(),r=t.x+Math.cos(e)*i,o=t.y+Math.sin(e)*i,s=t.radius*(.04+.06*Math.random());n.globalAlpha=.2+.3*Math.random(),n.beginPath(),n.arc(r,o,s,0,2*Math.PI),n.fill()}n.globalAlpha=1,t.rotation+=t.rotationSpeed*(1+.1*Math.sin(.3*t.pulse))}else if("sparkle"===a.type){const e=a;e.pulse+=.08+.02*Math.random();const i=.5+.5*Math.sin(e.pulse);Math.random()>.97?(n.fillStyle=`rgba(255, 255, 250, ${1.5*e.alpha})`,n.shadowColor="rgba(255, 255, 200, 0.8)",n.shadowBlur=5):(n.fillStyle=`rgba(255, 255, 220, ${e.alpha*i})`,n.shadowBlur=0),n.beginPath(),n.arc(e.x,e.y,e.radius*(.8+.4*i),0,2*Math.PI),n.fill(),n.shadowBlur=0,e.y+=e.speed,e.x+=.3*Math.sin(.2*e.pulse),e.y>t.height&&(e.y=0,e.x=Math.random()*t.width)}else"smallCloud"===a.type&&(m(a.x,a.y,a.radius,a.opacity),a.x+=a.speed,a.x>t.width+a.radius&&(a.x=2*-a.radius,a.y=Math.random()*(t.height/2)))}))},f=()=>{n.clearRect(0,0,t.width,t.height),n.fillStyle=l,n.fillRect(0,0,t.width,t.height),s.sort(((a,t)=>a.radius-t.radius)),s.forEach((a=>{"bigCloud"===a.type?M(a.x,a.y,a.radius,a.opacity,a.details):m(a.x,a.y,a.radius,a.opacity),a.x+=a.speed,a.x>t.width+a.radius&&(a.x=2*-a.radius,a.y=Math.random()*(.6*t.height),a.radius="bigCloud"===a.type?60*Math.random()+40:30*Math.random()+15)}))},m=(a,t,e,i)=>{n.fillStyle=`rgba(220, 220, 220, ${i})`,n.beginPath(),n.arc(a,t,.5*e,0,2*Math.PI),n.arc(a+.35*e,t-.2*e,.4*e,0,2*Math.PI),n.arc(a+.75*e,t,.45*e,0,2*Math.PI),n.arc(a+.4*e,t+.2*e,.35*e,0,2*Math.PI),n.fill(),n.fillStyle=`rgba(250, 250, 250, ${.6*i})`,n.beginPath(),n.arc(a,t-.12*e,.35*e,0,2*Math.PI),n.arc(a+.35*e,t-.3*e,.25*e,0,2*Math.PI),n.fill()},M=(a,t,e,i,r)=>{n.fillStyle=`rgba(180, 180, 180, ${.5*i})`,n.beginPath(),n.arc(a+5,t+5,.6*e,0,2*Math.PI),n.arc(a+.35*e+5,t-.2*e+5,.5*e,0,2*Math.PI),n.arc(a+.75*e+5,t+5,.55*e,0,2*Math.PI),n.fill(),n.fillStyle=`rgba(220, 220, 220, ${i})`,n.beginPath(),n.arc(a,t,.6*e,0,2*Math.PI),n.arc(a+.35*e,t-.2*e,.5*e,0,2*Math.PI),n.arc(a+.75*e,t,.55*e,0,2*Math.PI),n.arc(a+.4*e,t+.3*e,.45*e,0,2*Math.PI);for(let o=0;o<r;o++){const i=Math.cos(o*Math.PI/4)*e*.6,r=Math.sin(o*Math.PI/4)*e*.4;n.arc(a+i,t+r,.3*e,0,2*Math.PI)}n.fill(),n.fillStyle=`rgba(250, 250, 250, ${.7*i})`,n.beginPath(),n.arc(a,t-.15*e,.4*e,0,2*Math.PI),n.arc(a+.35*e,t-.35*e,.3*e,0,2*Math.PI),n.fill()},x=()=>{"rainy"===t.weather?y():"sunny"===t.weather?g():"cloudy"===t.weather&&f(),o=requestAnimationFrame(x)},w=()=>{o&&cancelAnimationFrame(o),x()};return(0,i.wB)((()=>t.weather),(a=>{o&&cancelAnimationFrame(o),s=[],h(),"rainy"===a?c():"sunny"===a?p():"cloudy"===a&&u(),w()})),(0,i.sV)((()=>{d(),window.addEventListener("resize",d)})),(0,i.hi)((()=>{o&&cancelAnimationFrame(o),window.removeEventListener("resize",d)})),(a,t)=>((0,i.uX)(),(0,i.CE)("canvas",{ref_key:"canvas",ref:e,class:"weather-canvas"},null,512))}},o=e(1241);const s=(0,o.A)(n,[["__scopeId","data-v-5cceed66"]]);var l=s}}]);
//# sourceMappingURL=666.9b9ccd70.js.map